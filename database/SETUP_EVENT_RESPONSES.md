# Настройка системы откликов на мероприятия

## Проблема
При нажатии кнопки "Буду" количество участников не обновляется.

## Решение

### 1. Проверьте настройку базы данных

Выполните в Supabase SQL Editor файл `database/CHECK_RESPONSES_SETUP.sql` чтобы проверить, создана ли система откликов.

### 2. Если система не создана, выполните настройку

**Если появляется ошибка "policy already exists":**
1. Используйте файл `database/ADD_EVENT_RESPONSES_SAFE.sql` вместо обычного
2. Этот файл безопасно создаст недостающие компоненты

**Обычная установка:**
1. Откройте Supabase Dashboard → SQL Editor
2. Скопируйте и выполните содержимое файла `database/ADD_EVENT_RESPONSES_SAFE.sql`
3. Проверьте сообщения в логах - должно быть "✅ Система откликов настроена успешно!"

**Если нужно начать заново:**
1. Выполните `database/CLEANUP_EVENT_RESPONSES.sql` (удалит все данные откликов!)
2. Затем выполните `database/ADD_EVENT_RESPONSES_SAFE.sql`

### 3. Проверьте результат

После выполнения SQL команд в базе данных должны появиться:

- Таблица `event_responses` 
- ENUM тип `response_status`
- Триггеры для автоматического обновления счетчика участников
- Функции для работы с откликами

### 4. Тестирование

1. Перезагрузите приложение
2. Нажмите кнопку "Буду" на любом мероприятии
3. Количество участников должно обновиться автоматически

## Техническое описание

При нажатии "Буду":
1. Данные отправляются в таблицу `event_responses`
2. Триггер автоматически пересчитывает `current_participants` в таблице `events`
3. Приложение обновляет данные из базы и показывает новое количество

## Отладка

Если проблема сохраняется, проверьте:
- Выполнены ли все SQL команды из `ADD_EVENT_RESPONSES.sql`
- Есть ли права на запись в таблицы
- Работают ли триггеры (можно проверить в Supabase Dashboard) 