<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="telegram-web-app" content="true">
    <title>Direct Link Test - Fiesta</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            line-height: 1.5;
        }
        .success { background: #d4edda; }
        .warning { background: #fff3cd; }
        .error { background: #f8d7da; }
        .test-link {
            display: block;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            text-decoration: none;
            color: #495057;
        }
        pre {
            background: #ffffff;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
            border: 1px solid #ddd;
            margin: 10px 0;
        }
        .instruction {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #2481cc;
        }
    </style>
</head>
<body>
    <h1>üîó Direct Link Test</h1>
    
    <div class="instruction">
        <h3>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:</h3>
        <ol>
            <li>–û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞: <a href="https://t.me/Fiesta_cursor_bot">@Fiesta_cursor_bot</a></li>
            <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É Menu –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /start</li>
            <li>–ö–æ–≥–¥–∞ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è Web App, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å—Å—ã–ª–∫–∏ –Ω–∏–∂–µ</li>
        </ol>
    </div>

    <h3>–¢–µ—Å—Ç–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏ (–æ—Ç–∫—Ä–æ–π—Ç–µ –≤ Telegram Web App):</h3>
    
    <a href="https://fiesta-cursor.netlify.app/direct-test.html?event=test123" class="test-link">
        <strong>–¢–µ—Å—Ç 1:</strong> ?event=test123<br>
        <small>–ü—Ä—è–º–æ–π URL –ø–∞—Ä–∞–º–µ—Ç—Ä</small>
    </a>

    <a href="https://fiesta-cursor.netlify.app/direct-test.html?event=c202282f-e06a-40e1-8ea7-e154518c4a6c" class="test-link">
        <strong>–¢–µ—Å—Ç 2:</strong> –†–µ–∞–ª—å–Ω—ã–π UUID —Å–æ–±—ã—Ç–∏—è<br>
        <small>–§–æ—Ä–º–∞—Ç –∫–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</small>
    </a>

    <a href="https://fiesta-cursor.netlify.app/?event=test123" class="test-link">
        <strong>–¢–µ—Å—Ç 3:</strong> –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º<br>
        <small>–ö–∞–∫ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</small>
    </a>

    <h3>–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:</h3>
    <div id="status"></div>

    <h3>–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:</h3>
    <pre id="params-info"></pre>

    <h3>Telegram WebApp –¥–∞–Ω–Ω—ã–µ:</h3>
    <pre id="telegram-info"></pre>

    <script>
        function updateInfo() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            const urlParams = new URLSearchParams(window.location.search);
            const eventParam = urlParams.get('event');
            
            const paramsInfo = {
                url: window.location.href,
                search: window.location.search,
                eventParam: eventParam,
                allParams: Object.fromEntries(urlParams)
            };
            
            // Telegram –¥–∞–Ω–Ω—ã–µ
            const telegramInfo = {
                available: typeof window.Telegram !== 'undefined',
                webAppAvailable: typeof window.Telegram?.WebApp !== 'undefined'
            };

            if (telegramInfo.webAppAvailable) {
                const webApp = window.Telegram.WebApp;
                telegramInfo.webApp = {
                    version: webApp.version,
                    platform: webApp.platform,
                    initData: webApp.initData ? 'present' : 'missing',
                    startParam: webApp.initDataUnsafe?.start_param || 'missing',
                    user: webApp.initDataUnsafe?.user ? 'present' : 'missing'
                };
            }

            document.getElementById('params-info').textContent = JSON.stringify(paramsInfo, null, 2);
            document.getElementById('telegram-info').textContent = JSON.stringify(telegramInfo, null, 2);

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            const statusDiv = document.getElementById('status');
            
            if (eventParam) {
                document.body.className = 'success';
                statusDiv.innerHTML = `
                    <div style="padding: 15px; background: #d4edda; border-radius: 8px; color: #155724;">
                        <h4>‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä —Å–æ–±—ã—Ç–∏—è –Ω–∞–π–¥–µ–Ω!</h4>
                        <p><strong>Event ID:</strong> ${eventParam}</p>
                        <p>–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç! –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä—è–º—ã–µ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.</p>
                    </div>
                `;
            } else if (telegramInfo.webAppAvailable) {
                document.body.className = 'warning';
                statusDiv.innerHTML = `
                    <div style="padding: 15px; background: #fff3cd; border-radius: 8px; color: #856404;">
                        <h4>‚ö†Ô∏è Telegram WebApp —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h4>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å—Å—ã–ª–∫–∏ –≤—ã—à–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.</p>
                    </div>
                `;
            } else {
                document.body.className = 'error';
                statusDiv.innerHTML = `
                    <div style="padding: 15px; background: #f8d7da; border-radius: 8px; color: #721c24;">
                        <h4>‚ùå Telegram WebApp –Ω–µ –Ω–∞–π–¥–µ–Ω</h4>
                        <p>–û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞.</p>
                    </div>
                `;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateInfo();
            
            if (window.Telegram?.WebApp) {
                try {
                    window.Telegram.WebApp.ready();
                    window.Telegram.WebApp.expand();
                } catch (e) {
                    console.error('Telegram WebApp initialization error:', e);
                }
            }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
        setInterval(updateInfo, 2000);
    </script>
</body>
</html> 